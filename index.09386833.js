let userName;userName=prompt("What is yout nickname?")||"Anonymous";const ws=new WebSocket("ws://websocket-chat-backend.glitch.me"),chat=document.getElementById("chat"),lastMsgName=document.querySelector(".active  .last-msg-name"),lastMsgPreview=document.querySelector(".active .chat-list-item-preview-msg"),counter=document.querySelector(".active .new-msg-counter"),onlineCounter=document.querySelector(".chat-subtitle"),timeStringLength=5;window.addEventListener("focus",(()=>{chat.scrollTo({top:chat.scrollHeight,behavior:"smooth"})}));let unreadMsgCount=0;ws.onopen=()=>{ws.send(JSON.stringify({userName:userName}))},ws.onmessage=({data:e})=>{const t=JSON.parse(e);if(t.online&&(onlineCounter.textContent=`${t.online} members online`),t.userName&&chat.insertAdjacentHTML("beforeend",`<p class="connection-message">${t.userName} has joined the chat</p>`),t.time){const{name:e,message:s,time:n}=t;chat.insertAdjacentHTML("beforeend",`<p class="user-message">\n        <span class="user-name">${e}</span>\n        <span class="user-chat-message">${s}<span class="time">${n}</span></span>\n            \n      </p>\n      <div class="clear"></div>`),lastMsgName.textContent=`${e}: `,lastMsgPreview.textContent=`${s}`,unreadMsgCount+=1,counter.innerHTML=0!==unreadMsgCount?unreadMsgCount:1,document.hasFocus()&&(unreadMsgCount=0,counter.innerHTML="",chat.scrollTo({top:chat.scrollHeight,behavior:"smooth"}))}};const chatForm=document.getElementById("chat-form");chatForm.addEventListener("submit",(function(e){e.preventDefault();const t=this.elements.message.value,s=(new Date).toLocaleTimeString().slice(0,5),n={name:userName,message:t,time:s};ws.send(JSON.stringify(n)),this.reset(),chat.insertAdjacentHTML("beforeend",`<p class="your-message">\n     <span class="your-chat-message">${t}<span class="time">${s}</span></span>\n     </p>`),lastMsgName.textContent=`${userName}: `,lastMsgPreview.textContent=`${t}`,chat.scrollTo({top:chat.scrollHeight,behavior:"smooth"}),document.hasFocus()&&(unreadMsgCount=0,counter.innerHTML="",console.log("Tab is active"))}));
//# sourceMappingURL=index.09386833.js.map
