{"mappings":"AAAA,IAAIA,SACJA,SAAWC,OAAO,2BAA6B,YAE/C,MAAMC,GAAK,IAAIC,UAAU,yCACnBC,KAAOC,SAASC,eAAe,QAC/BC,YAAcF,SAASG,cAAc,2BACrCC,eAAiBJ,SAASG,cAC9B,uCAEIE,QAAUL,SAASG,cAAc,4BACjCG,cAAgBN,SAASG,cAAc,kBAEvCI,iBAAmB,EAEzBC,OAAOC,iBAAiB,SAAO,KAC7BV,KAAKW,SAAS,CAAEC,IAAKZ,KAAKa,aAAcC,SAAU,cAGpD,IAAIC,eAAiB,EAErBjB,GAAGkB,OAAM,KACPlB,GAAGmB,KAAKC,KAAKC,UAAU,CAAEvB,SAAAA,aAG3BE,GAAGsB,UAAS,EAAMC,KAAAA,MAChB,MAAMC,EAASJ,KAAKK,MAAMF,GAa1B,GAXIC,EAAOE,SACTjB,cAAckB,YAAW,GAAMH,EAAOE,yBAGpCF,EAAO1B,UACTI,KAAK0B,mBACH,YAAW,iCACsBJ,EAAO1B,oCAIxC0B,EAAOK,KAAM,CACf,MAAMC,KAAEA,EAAIC,QAAEA,EAAOF,KAAEA,GAASL,EAChCtB,KAAK0B,mBACH,YAAW,6DAEiBE,qDACQC,uBAA6BF,8EAMnExB,YAAYsB,YAAW,GAAMG,MAC7BvB,eAAeoB,YAAW,GAAMI,IAEhCd,gBAAkB,EAEbT,QAAQwB,UADM,IAAnBf,eACyBA,eACA,EAErBd,SAAS8B,aACXhB,eAAiB,EACjBT,QAAQwB,UAAY,GAEpB9B,KAAKW,SAAS,CAAEC,IAAKZ,KAAKa,aAAcC,SAAU,cAKxD,MAAMkB,SAAW/B,SAASC,eAAe,aACzC8B,SAAStB,iBAAiB,UAAU,SAAUuB,GAC5CA,EAAEC,iBACF,MAAML,EAAUM,KAAKC,SAASP,QAAQQ,MAChCV,GAAO,IAAIW,MAAOC,qBAAqBC,MAAM,EA3D5B,GA6DjBnB,EAAO,CACXO,KAAMhC,SACNiC,QAAAA,EACAF,KAAAA,GAGF7B,GAAGmB,KAAKC,KAAKC,UAAUE,IACvBc,KAAKM,QACLzC,KAAK0B,mBACH,YAAW,kEAEwBG,uBAA6BF,8BAGlExB,YAAYsB,YAAW,GAAM7B,aAC7BS,eAAeoB,YAAW,GAAMI,IAEhC7B,KAAKW,SAAS,CAAEC,IAAKZ,KAAKa,aAAcC,SAAU,WAC9Cb,SAAS8B,aACXhB,eAAiB,EACjBT,QAAQwB,UAAY,GACpBY,QAAQC,IAAI","sources":["src/chat.js"],"sourcesContent":["let userName;\r\nuserName = prompt('What is yout nickname?') || 'Anonymous';\r\n\r\nconst ws = new WebSocket('ws://websocket-chat-backend.glitch.me');\r\nconst chat = document.getElementById('chat');\r\nconst lastMsgName = document.querySelector('.active  .last-msg-name');\r\nconst lastMsgPreview = document.querySelector(\r\n  '.active .chat-list-item-preview-msg',\r\n);\r\nconst counter = document.querySelector('.active .new-msg-counter');\r\nconst onlineCounter = document.querySelector('.chat-subtitle');\r\n\r\nconst timeStringLength = 5;\r\n\r\nwindow.addEventListener('focus', () => {\r\n  chat.scrollTo({ top: chat.scrollHeight, behavior: 'smooth' });\r\n});\r\n\r\nlet unreadMsgCount = 0;\r\n\r\nws.onopen = () => {\r\n  ws.send(JSON.stringify({ userName }));\r\n};\r\n\r\nws.onmessage = ({ data }) => {\r\n  const parsed = JSON.parse(data);\r\n\r\n  if (parsed.online) {\r\n    onlineCounter.textContent = `${parsed.online} members online`;\r\n  }\r\n\r\n  if (parsed.userName) {\r\n    chat.insertAdjacentHTML(\r\n      'beforeend',\r\n      `<p class=\"connection-message\">${parsed.userName} has joined the chat</p>`,\r\n    );\r\n  }\r\n\r\n  if (parsed.time) {\r\n    const { name, message, time } = parsed;\r\n    chat.insertAdjacentHTML(\r\n      'beforeend',\r\n      `<p class=\"user-message\">\r\n        <span class=\"user-name\">${name}</span>\r\n        <span class=\"user-chat-message\">${message}<span class=\"time\">${time}</span></span>\r\n            \r\n      </p>\r\n      <div class=\"clear\"></div>`,\r\n    );\r\n\r\n    lastMsgName.textContent = `${name}: `;\r\n    lastMsgPreview.textContent = `${message}`;\r\n\r\n    unreadMsgCount += 1;\r\n    unreadMsgCount !== 0\r\n      ? (counter.innerHTML = unreadMsgCount)\r\n      : (counter.innerHTML = 1);\r\n\r\n    if (document.hasFocus()) {\r\n      unreadMsgCount = 0;\r\n      counter.innerHTML = '';\r\n\r\n      chat.scrollTo({ top: chat.scrollHeight, behavior: 'smooth' });\r\n    }\r\n  }\r\n};\r\n\r\nconst chatForm = document.getElementById('chat-form');\r\nchatForm.addEventListener('submit', function (e) {\r\n  e.preventDefault();\r\n  const message = this.elements.message.value;\r\n  const time = new Date().toLocaleTimeString().slice(0, timeStringLength);\r\n\r\n  const data = {\r\n    name: userName,\r\n    message,\r\n    time,\r\n  };\r\n\r\n  ws.send(JSON.stringify(data));\r\n  this.reset();\r\n  chat.insertAdjacentHTML(\r\n    'beforeend',\r\n    `<p class=\"your-message\">\r\n     <span class=\"your-chat-message\">${message}<span class=\"time\">${time}</span></span>\r\n     </p>`,\r\n  );\r\n  lastMsgName.textContent = `${userName}: `;\r\n  lastMsgPreview.textContent = `${message}`;\r\n\r\n  chat.scrollTo({ top: chat.scrollHeight, behavior: 'smooth' });\r\n  if (document.hasFocus()) {\r\n    unreadMsgCount = 0;\r\n    counter.innerHTML = '';\r\n    console.log('Tab is active');\r\n  }\r\n});\r\n"],"names":["userName","prompt","ws","WebSocket","chat","document","getElementById","lastMsgName","querySelector","lastMsgPreview","counter","onlineCounter","timeStringLength","window","addEventListener","scrollTo","top","scrollHeight","behavior","unreadMsgCount","onopen","send","JSON","stringify","onmessage","data","parsed","parse","online","textContent","insertAdjacentHTML","time","name","message","innerHTML","hasFocus","chatForm","e","preventDefault","this","elements","value","Date","toLocaleTimeString","slice","reset","console","log"],"version":3,"file":"index.09386833.js.map"}